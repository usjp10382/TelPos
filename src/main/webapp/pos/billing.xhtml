<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:p="http://primefaces.org/ui">

<h:body>

	<ui:composition template="/template/common/commonLayout.xhtml">
		<ui:define name="content">
			<script type="text/javascript" language="javascript">
				
			</script>

			<!-- Top Icon Button - Start -->
			<div class="p-grid">
				<div class="p-col-12" align="right">

					<div style="display: inline;">
						<p:commandButton icon="fa fa-user-plus" style="margin-right:5px;"
							type="button" id="cusAdd" title="Add Customer"
							widgetVar="btnAddCus" onclick="PF('cusAdd').show();" />
						<p:hotkey bind="shift+c" handler="PF('cusAdd').show();"
							id="hotAddCus" />
					</div>

					<div style="display: inline;">
						<p:commandButton icon="fa fa-male" style="margin-right:5px;"
							type="button" id="lab" title="Labour Charges"
							onclick="PF('labCost').show();" />
						<p:hotkey bind="shift+l" handler="PF('labCost').show();"
							id="hotAddLab" />
					</div>

					<div style="display: inline;">
						<p:commandButton icon="fa fa-truck" style="margin-right:5px;"
							type="button" id="transport" title="Transport Charges"
							onclick="PF('transCost').show();" />
						<p:hotkey bind="shift+t" handler="PF('transCost').show();"
							id="hotAddTra" />
					</div>

					<div style="display: inline;">
						<p:commandButton icon="fa fa-calculator" style="margin-right:5px;"
							type="button" id="cal" title="UOM Calculator" />
					</div>

				</div>
			</div>
			<!-- Top Icon Button - End -->

			<!-- Invoice - Start -->
			<p:fieldset legend="Invoice" id="fldInv">
				<h:form id="invoceForm"
					onkeypress="if (event.keyCode == 13) { return false; }">

					<p:growl id="growl" sticky="false" life="5000" showDetail="true"
						showSummary="false" />
					<!-- Body - Start -->
					<div class="p-grid">
						<div class="p-col-12">

							<!-- Header Details - Start -->
							<div class="p-grid">
								<div class="p-col-6">

									<div>
										<h4>
											Invoice ID : <span>001</span>
										</h4>
									</div>

									<div>
										<p:outputLabel value="Customer Name" for="@next" />
										<br />
										<p:autoComplete id="cusName" dropdown="true" size="40"
											value="#{invController.selectedCustomer}" var="cus"
											forceSelection="true" queryDelay="700"
											widgetVar="autocomplete" itemLabel="#{cus}"
											minQueryLength="3" itemValue="#{cus}"
											completeMethod="#{invController.completeCustomerContains}"
											onkeypress="if (event.keyCode == 13) {PF('wgitemDetails').jq.focus(); return false; }"
											converter="cusConvertor">
											<p:ajax event="itemSelect" update=":cusDetails" />
										</p:autoComplete>


										<p:commandButton type="button" icon="fa fa-info-circle"
											title="View Customer Details" styleClass="info-btn"
											onclick="PF('cusDetails').show();">
										</p:commandButton>
									</div>

								</div>

								<div class="p-col-6" align="right">
									<p:clock displayMode="analog" />
								</div>
								<div class="p-col-12">
									<p:separator />
								</div>
							</div>
							<!-- Header Details - End -->

							<!-- Item Details - Start -->
							<div class="p-grid">
								<div class="p-col-5">
									<p:outputLabel value="Item" for="@next" />
									<br />
									<p:autoComplete id="itemDetails" dropdown="true"
										widgetVar="wgitemDetails" style="width: 80%"
										completeMethod="#{invController.completeItemsContains}"
										var="item" value="#{invController.selectedItem}"
										forceSelection="true" queryDelay="700" itemLabel="#{item}"
										minQueryLength="3" itemValue="#{item}"
										onkeypress="if (event.keyCode == 13) {PF('wgqty').jq.focus(); return false; }"
										converter="itemConvertor" inputStyle="width: 90%">
										<p:ajax event="itemSelect"
											listener="#{invController.onItemSelect}" update="uom,uPrice" />
									</p:autoComplete>

									<p:commandButton type="button" icon="fa fa-info-circle"
										title="View Itemf Details" styleClass="info-btn"
										onclick="PF('itemDet').show();">
									</p:commandButton>
								</div>

								<div class="p-col-1">
									<p:outputLabel value="UOM" for="@next" />
									<br />
									<p:inputText id="uom" style="width:100%" readonly="true"
										value="#{invController.selectedItem.product.uom.uomChar}" />
								</div>

								<div class="p-col-2">
									<p:outputLabel value="Quantity" for="@next" />
									<br />
									<p:inputText id="qty" type="number" widgetVar="wgqty"
										style="width:100%" />
								</div>


								<div class="p-col-2">
									<p:outputLabel value="Unit Price" for="@next" />
									<br />
									<p:inputText type="number" widgetVar="wgprice" id="uPrice"
										value="#{invController.selectedItem.sellingPrice}"
										style="width:100%" />
								</div>

								<div class="p-col-2">
									<p:outputLabel value="Discount" for="@next" />
									<br />
									<h:inputText type="number" id="discount" style="width:100%"
										maxlength="2" />
								</div>

								<div class="p-col-12">
									<p:separator />
								</div>
							</div>
							<!-- Item Details - End -->

							<!-- Item Table - Start -->
							<div class="p-grid">
								<div class="p-col-8">
									<p:dataTable resizableColumns="true" var="invoTable"
										id="invoItemTable">
										<p:column headerText="Item No">
											<h:outputText value="#{grnDet.grnDetNumber}" />
										</p:column>

										<p:column headerText="Item Code">
											<h:outputText value="#{grnDet.product.prdCode}" />
										</p:column>

										<p:column headerText="Item Name">
											<h:outputText value="#{grnDet.product.prdCode}" />
										</p:column>

										<p:column headerText="Brand">
											<h:outputText value="#{grnDet.product.prdCode}" />
										</p:column>

										<p:column headerText="Qty">
											<h:outputText value="#{grnDet.product.prdCode}" />
										</p:column>

										<p:column headerText="Unit Price">
											<h:outputText value="#{grnDet.product.prdCode}" />
										</p:column>

										<p:column headerText="Discount">
											<h:outputText value="#{grnDet.product.prdCode}" />
										</p:column>

										<p:column headerText="Total">
											<h:outputText value="#{grnDet.product.prdCode}" />
										</p:column>

										<p:column style="width:32px;text-align: center">
											<p:commandButton icon="pi pi-trash" title="Delete"
												style="width:20px;height:20px" styleClass="red-button">
											</p:commandButton>
										</p:column>
									</p:dataTable>
								</div>
								<!-- Item Table - End -->

								<!-- Item Payment Details - Start -->
								<div class="p-col-4" align="center"
									style="display: block; border: solid 1px #1387C4; margin-top: 10px">
									<table>
										<tr>
											<td><h4>Total Amount</h4></td>
											<td><h4>:</h4></td>
											<td><p:inputText id="totAmount"
													styleClass="read-only-btn" readonly="true" /></td>
										</tr>

										<tr>
											<td><h4>Discount (%)</h4></td>
											<td><h4>:</h4></td>
											<td><p:inputText id="dis" /></td>
										</tr>

										<tr>
											<td><h4>Labour Charges</h4></td>
											<td><h4>:</h4></td>
											<td><p:inputText id="laborCharges"
													styleClass="read-only-btn" readonly="true" /></td>
										</tr>

										<tr>
											<td><h4>Transport Charges</h4></td>
											<td><h4>:</h4></td>
											<td><p:inputText id="transportCharges"
													styleClass="read-only-btn" readonly="true" /></td>
										</tr>

										<tr>
											<td><h4>Payble Amount</h4></td>
											<td><h4>:</h4></td>
											<td><p:inputText id="paybleAmount"
													styleClass="read-only-btn" readonly="true" /></td>
										</tr>

										<tr>
											<td><h4>Payment Type</h4></td>
											<td><h4>:</h4></td>
											<td><p:selectOneMenu id="pType" style="width:100%">

												</p:selectOneMenu></td>
										</tr>

										<tr>
											<td><h4>Cash Payment</h4></td>
											<td><h4>:</h4></td>
											<td><p:inputText id="cPay" /></td>
										</tr>

										<tr>
											<td><h4>Cheque Payment</h4></td>
											<td><h4>:</h4></td>
											<td><p:inputText id="cheqPay" /></td>
										</tr>

										<tr>
											<td><h4>Total Paid Amount</h4></td>
											<td><h4>:</h4></td>
											<td><p:inputText id="paidAmount"
													styleClass="read-only-btn" readonly="true" /></td>
										</tr>


										<tr>
											<td><h4>Balance Amount</h4></td>
											<td><h4>:</h4></td>
											<td><p:inputText id="balanceAmount"
													styleClass="read-only-btn" readonly="true" /></td>
										</tr>
									</table>

									<p:commandButton value="Create Invoice"
										icon="pi pi-check-circle"
										style="margin-right:20px;margin-top:10px;width:100%"
										widgetVar="btnSave">
									</p:commandButton>

								</div>
								<!-- Item Payment Details - End -->
							</div>

						</div>
					</div>
					<!-- Body - End -->

				</h:form>
			</p:fieldset>
			<!-- Invoice - End -->

			<!-- Add Labour Cost - Start -->
			<p:dialog header="Add Labour Cost" widgetVar="labCost"
				showEffect="clip" hideEffect="clip" height="100%" width="25%">
				<h:form id="labCostForm">

					<div class="p-col-12" align="center">
						<p:outputLabel value="Add the Cost" for="@next" />
						<br />
						<p:inputText id="labCost" style="width:100%" />
					</div>

				</h:form>
			</p:dialog>
			<!-- Add Labour Cost - End -->

			<!-- Add Transport Cost - Start -->
			<p:dialog header="Add Transport Cost" widgetVar="transCost"
				showEffect="clip" hideEffect="clip" height="100%" width="25%">
				<h:form id="transCostForm">

					<div class="p-col-12" align="center">
						<p:outputLabel value="Add the Cost" for="@next" />
						<br />
						<p:inputText id="transCost" style="width:100%" />
					</div>

				</h:form>
			</p:dialog>
			<!-- Add Transport Cost - End -->

			<!-- Customer More Details - Start -->
			<p:dialog header="Customer Details" widgetVar="cusDetails"
				dynamic="true" showEffect="clip" hideEffect="clip" height="100%"
				width="50%">
				<h:form id="cusDetails">

					<div class="p-col-12">
						<p:outputLabel value="Customer Name" for="@next" />
						<br />
						<p:inputText id="cusName"
							value="#{invController.selectedCustomer.firstName} #{invController.selectedCustomer.lastName}"
							style="width:100%" readonly="true" />
					</div>

					<div class="p-col-12">
						<p:outputLabel value="Customer Address" for="@next" />
						<br />
						<p:inputText id="cusaddress"
							value="#{invController.selectedCustomer.address}"
							style="width:100%" readonly="true" />
					</div>

					<div class="p-col-12">
						<p:outputLabel value="Mobile Number" for="@next" />
						<br />
						<p:inputText id="mobileNo"
							value="#{invController.selectedCustomer.mobileNumber}"
							style="width:100%" readonly="true" />
					</div>

				</h:form>
			</p:dialog>
			<!-- Customer More Details - End -->

			<!-- Customer Add - Start -->
			<p:dialog header="New Customer" widgetVar="cusAdd" showEffect="clip"
				appendTo="fldInv" hideEffect="clip" height="100%" width="40%">
				<h:form id="cusNewAdd">

					<div class="p-col-12">
						<p:outputLabel value="First Name" for="@next" />
						<br />
						<p:inputText id="cusFirstAddName" style="width:100%"
							value="#{invController.newCusFirstName}" required="true"
							requiredMessage="First Name Is Required!" />
					</div>

					<div class="p-col-12">
						<p:outputLabel value="Last Name" for="@next" />
						<br />
						<p:inputText id="cusLastAddName" style="width:100%"
							required="true" requiredMessage="Last Name Is Required!"
							value="#{invController.newCusLastName}" />
					</div>

					<div class="p-col-12">
						<p:outputLabel value="Mobile Number" for="@next" />
						<br />
						<p:inputMask autoClear="true" maxlength="11" mask="+94-999999999"
							required="true" requiredMessage="Mobile Number Is Required!"
							value="#{invController.newMobile}" id="cusAddMobileNo"
							style="width:100%" />
					</div>

					<div class="p-col-12">
						<p:outputLabel value="Customer Address" for="@next" />
						<br />
						<p:inputText id="cusAddaddress" style="width:100%" required="true"
							value="#{invController.newAddress}"
							onkeypress="if (event.keyCode === 13) { addCus(); return false; }"
							requiredMessage="Address Is Required !" />
					</div>


					<p:remoteCommand name="addCus"
						action="#{invController.createNewCustomer}"
						oncomplete="if(!args.validationFailed){PF('cusAdd').hide();}"
						process="@form"
						update="cusNewAdd,:invoceForm:growl,:invoceForm:cusName" />

					<div class="p-col-12" align="right">
						<p:commandButton value="Add Customer" icon="pi pi-check"
							action="#{invController.createNewCustomer}" process="@form"
							update="cusNewAdd,:invoceForm:growl,:invoceForm:cusName"
							oncomplete="if(!args.validationFailed){PF('cusAdd').hide();}">
							<p:confirm header="Confirm Create New Customer"
								icon="pi pi-check-circle"
								message="Are You Sure Create New Customer?" />
						</p:commandButton>
					</div>

				</h:form>
			</p:dialog>
			<!-- Customer Add - End -->

			<!-- Item Details - Start -->
			<p:dialog header="Item Details" widgetVar="itemDet" showEffect="clip"
				hideEffect="clip" height="100%" width="40%">
				<h:form id="itemDetForm">

					<div class="p-col-12">
						<p:outputLabel value="Item Code" for="@next" />
						<br />
						<p:inputText id="itemCode" style="width:100%" readonly="true" />
					</div>

					<div class="p-col-12">
						<p:outputLabel value="Product Name" for="@next" />
						<br />
						<p:inputText id="pName" style="width:100%" readonly="true" />
					</div>

					<div class="p-col-12">
						<p:outputLabel value="Brand" for="@next" />
						<br />
						<p:inputText id="brand" style="width:100%" readonly="true" />
					</div>

					<div class="p-col-12">
						<p:outputLabel value="Caegory" for="@next" />
						<br />
						<p:inputText id="category" style="width:100%" readonly="true" />
					</div>


					<div class="p-col-12">
						<p:outputLabel value="UOM" for="@next" />
						<br />
						<p:inputText id="uom" style="width:100%" readonly="true" />
					</div>

					<div class="p-col-12">
						<p:outputLabel value="Expire Date" for="@next" />
						<br />
						<p:inputText id="expDate" style="width:100%" readonly="true" />
					</div>

					<div class="p-col-12">
						<p:outputLabel value="Rack No" for="@next" />
						<br />
						<p:inputText id="rackNo" style="width:100%" readonly="true" />
					</div>
				</h:form>
			</p:dialog>
			<!-- Item Details - End -->

			<p:confirmDialog global="true" showEffect="explode" hideEffect="puff">
				<p:commandButton value="YES" type="button"
					styleClass="ui-confirmdialog-yes" icon="pi pi-check" />
				<p:commandButton value="NO" type="button"
					styleClass="red-button ui-confirmdialog-no" icon="pi pi-times" />
			</p:confirmDialog>

			<!-- Start Block Page Extentions -->

			<pe:blockUI target="fldInv" widgetVar="onLoadBlock" autoShow="true">
				<h:panelGrid columns="2">
					<p:graphicImage value="../resources/img/ajax-loader.gif"
						style="margin-right: 12px; vertical-align: middle;" />
					<h:outputText value="Sending  GRN Email......"
						style="white-space: nowrap;" />
				</h:panelGrid>
			</pe:blockUI>


		</ui:define>

		<p:ajaxStatus onstart="PF('statusDialog').show()"
			onsuccess="PF('statusDialog').hide()" />

		<p:dialog widgetVar="statusDialog" modal="true" draggable="false"
			closable="false" resizable="false" showHeader="false">
			<p:graphicImage value="../resources/img/ajax-loader.gif" />
		</p:dialog>

	</ui:composition>

</h:body>
</html>


